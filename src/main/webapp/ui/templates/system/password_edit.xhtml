<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">
<h:body>
	<p:panel styleClass="rich-table-edit" cellpadding="5">
		<fieldset class="fieldset ">
			<legend>
				<h:outputText value="#{bundle['changepassword']}" />
				▼
			</legend>
			<p:panelGrid id="editGrid">

				<p:row>
					<p:column styleClass="rich-table-edit-outputtext">
						<p:outputLabel for="modnameInput" value="#{bundle['userid']}:" />
					</p:column>
					<p:column styleClass="rich-table-edit-left">
						<p:inputText id="modnameInput" title="请输入帐号" readonly="true"
							type="text" maxlength="50"
							value="#{userMaintainBean.userInfo.userid}" />
					</p:column>
				</p:row>
				<p:row>
					<p:column styleClass="rich-table-edit-outputtext">
						<p:outputLabel for="oldpwdInput"
							value="#{bundle['plsinputoldpwd']}:" />

					</p:column>
					<p:column styleClass="rich-table-edit-left">
						<p:password tabindex="2" title="#{bundle['oldpassword']}"
							style="width:96.5%;" id="oldpwdInput"
							value="#{userMaintainBean.userInfo.newpassword}" >
							<a4j:ajax event="blur" execute="@this" 
								listener="#{userMaintainBean.checkPassword}" />
						</p:password>
					</p:column>

				</p:row>
				<p:row>
					<p:column styleClass="rich-table-edit-outputtext">
						<p:outputLabel for="newpwdInput" value="#{bundle['plsinputpwd']}:" />
					</p:column>
					<p:column styleClass="rich-table-edit-left">
						<p:password id="newpwdInput" title="#{bundle['newpassword']}"
							style="width:96.5%;"
							value="#{userMaintainBean.userInfo.newpassword}"
							match="confirmpwdInput"
							validatorMessage="#{bundle['confirmpasswordnotequalsnewpassword']}" />
					</p:column>
				</p:row>
				<p:row>
					<p:column styleClass="rich-table-edit-outputtext">
						<p:outputLabel for="confirmpwdInput"
							value="#{bundle['plsinputconfirmpwd']}:" />
					</p:column>
					<p:column styleClass="rich-table-edit-left">
						<p:password id="confirmpwdInput"
							title="#{bundle['confirmpassword']}" 
							style="width:96.5%;"
							requiredMessage="#{bundle['confirmpassword']}不能为空"
							value="#{userMaintainBean.userInfo.newpassword}" />
					</p:column>

				</p:row>
			</p:panelGrid>
			<p:messages autoUpdate="true" closable="true" showDetail="true" redisplay="false" ></p:messages>
			<p:panelGrid style="width:100%;text-align:right;">
				<p:row>
					<p:column>
						<a4j:commandButton value="#{bundle['save']}" styleClass="btn"
							style="background-image: url('#{request.contextPath}/images/button-bg.png') ;"
							action="#{userMaintainBean.changePassword}"
							render="changepwdmsg,msg" execute="editPane"
							oncomplete="if (#{facesContext.maximumSeverity.ordinal le 0}) {#{rich:component('editPane')}.hide();}" />
					</p:column>
				</p:row>
			</p:panelGrid>
		</fieldset>
		<rich:message id="changepwdmsgs" />
	</p:panel>
</h:body>
</html>

